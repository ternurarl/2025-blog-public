# MISC

### å°è“é²¨çš„ç¥ç§˜æ–‡ä»¶

ä¸‹è½½è§£å‹å‡ºä¸€ä¸ªå«`ChsPinyinUDL.dat`<font style="color:rgb(51, 51, 51);">çš„æ–‡ä»¶</font>

<font style="color:rgb(51, 51, 51);">ç›´æ¥è°·æ­Œæœç´¢å¯ä»¥å¾—çŸ¥æ˜¯å¾®è½¯æ‹¼éŸ³çš„</font>**<font style="color:rgb(51, 51, 51);">è‡ªå­¦ä¹ è¯åº“æ–‡ä»¶</font>**

> åœ¨`C:\Users\username\AppData\Roaming\Microsoft\InputMethod\Chs`ä¸‹æœ‰ä¸¤ä¸ª`ChsPinyinUDL.dat å’Œ </font>`<font style="color:rgb(51, 51, 51);background-color:rgb(243, 244, 244);">ChsPinyinIH.dat</font>`æ–‡ä»¶é‡Œé¢æœ‰è®°å½•è¯é¢‘ä¿¡æ¯ã€‚

<font style="color:rgb(119, 119, 119);">ä¾æ®ä¸Šè¿°åŸºäºæ•°æ®æµçš„é€†å‘æµ‹è¯•ç­–ç•¥ï¼Œå¯¹ä¸¤ä¸ª DAT ç”¨æˆ·è¯åº“æ–‡ä»¶è¿›è¡Œç»“æ„åˆ†æï¼Œå‘ç° ChsPinyinlH å’Œ ChsPinyÂ­inÂ­UDL ä¸¤ä¸ª DAT æ–‡ä»¶å­˜å‚¨çš„è¾“å…¥è®°å½•ä¿¡æ¯æ•°æ®èµ·å§‹ä½ç½®åˆ†åˆ«æ˜¯åœ¨æ–‡ä»¶åç§»åœ°å€ 0x1400 å¤„å’Œ 0x2400 å¤„ï¼Œæ¯æ¡ç”¨æˆ·è¾“å…¥è®°å½•ä¿¡æ¯çš„å­˜å‚¨é•¿åº¦éƒ½æ˜¯å›ºå®šçš„ï¼Œå ç”¨ 60 ä¸ªå­—èŠ‚ã€‚</font>

ç»“æ„å¦‚ä¸‹

![](https://md-img.serverrlrow.workers.dev/img/1765028107344-00e64ba0-f782-4c15-a1b7-a554ff8922ca.png)<font style="color:rgb(51, 51, 51);">chsPinyinIHç»“æ„.jpg</font>

![](https://md-img.serverrlrow.workers.dev/img/1765028107723-65d6ac9c-5edf-4958-96ae-07df82d522ba.png)<font style="color:rgb(51, 51, 51);">ChsPinyinUDLç»“æ„.jpg</font>

<font style="color:rgb(51, 51, 51);">åˆ©ç”¨ </font>[<font style="color:rgb(65, 131, 196);">å¾®è½¯æ‹¼éŸ³è‡ªå­¦ä¹ è¯åº“çš„å¯¼å…¥å¯¼å‡ºç®—æ³•</font>](https://github.com/studyzy/imewlconverter/issues/58)<font style="color:rgb(51, 51, 51);">ä¸­ @HowcanoeWang çš„</font>[<font style="color:rgb(65, 131, 196);">è„šæœ¬</font>](https://github.com/studyzy/imewlconverter/files/4365598/pinyin.zip)<font style="color:rgb(51, 51, 51);">ï¼Œå°±èƒ½è·å¾—è¾“å…¥è®°å½•ã€‚</font>

<font style="color:rgb(51, 51, 51);">è¿è¡Œè„šæœ¬å¾—åˆ°</font>

> <font style="color:rgb(119, 119, 119);">å¸®æˆ‘ä¼˜åŒ–è¿™æ®µä»£ç 	bang wo you hua zhe duan dai ma	1ä¸è¦ä¹±åŠ¨æˆ‘çš„ä»£ç 	bu yao luan dong wo de dai ma	1ä¸è¦åŠ¨æˆ‘åŸæ¥çš„ä»£ç 	bu yao dong wo yuan lai de dai ma	1å‡ºé¢˜äººè¯´å¼—è±æ ¼åœ¨å®˜ç½‘	chu ti ren shuo fu lai ge zai guan wang	1å‡ºé¢˜äººè¯´å¼—è±æ ¼åœ¨é‚£é‡Œ	chu ti ren shuo fu lai ge zai na li	1å®˜ç½‘çš„æ–°é—»é‡Œ	guan wang de xin wen li	1å¼—è±æ ¼	fu lai ge	1è¿˜æœ‰ä¸€äº›é¡¹ç›®åˆä½œçš„æœºä¼š	hai you yi xie xiang mu he zuo de ji hui	1ç¦å·è“é²¨ä¿¡æ¯æŠ€æœ¯æœ‰é™å…¬å¸	fu zhou lan sha xin xi ji shu you xian gong si	1æœºä¼šæ˜¯ç•™ç»™æœ‰å‡†å¤‡çš„äºº	ji hui shi liu gei you zhun bei de ren	1çœ‹çœ‹å®˜ç½‘çš„æ–°é—»å§	kan kan guan wang de xin wen ba	1ä½ æŠŠç®€å†æŠ•äº†å†è¯´	ni ba jian li tou le zai shuo	1ä½ å»çœ‹çœ‹æ–°é—»åŠ¨æ€å‘¢	ni qu kan kan xin wen dong tai ne	1ä½ å»æ‰¾è¾…å¯¼å‘˜é—®é—®	ni qu zhao fu dao yuan wen wen	1ä½ å»è“é²¨å®˜ç½‘çœ‹çœ‹å‘—	ni qu lan sha guan wang kan kan bei	1ä½ è¿™ä¸ªè„šæœ¬è·‘ä¸äº†å•Š	ni zhe ge jiao ben pao bu liao a	1ä»–ä»¬æ‹›å®ä¹ çš„	ta men zhao shi xi de	1è¿™æ¬¡æ¯”èµ›ä½ å‚åŠ äº†å—	zhe ci bi sai ni can jia le ma	1çœŸçš„å¯ä»¥å»è¯•è¯•	zhen de ke yi qu shi shi	1åœ¨æˆ‘åŸæ¥çš„åŸºç¡€ä¸Šä¿®æ”¹	zai wo yuan lai de ji chu shang xiu gai	1</font>

<font style="color:rgb(51, 51, 51);">åœ¨å°è“é²¨å®˜ç½‘å¯ä»¥æ‰¾åˆ°flag</font>

### å†²åˆºï¼å·æ‘¸é›¶ï¼

<font style="color:rgb(51, 51, 51);">ä¸‹è½½ä¸‹æ¥æ˜¯ä¸ªjaråŒ…,å¯ä»¥ç›´æ¥è¿è¡Œ,æ˜¯ä¸ªå°æ¸¸æˆ</font>

<font style="color:rgb(51, 51, 51);">ç”¨</font>`jadx-gui`<font style="color:rgb(51, 51, 51);">æ‰“å¼€æ–‡ä»¶</font>

![](https://md-img.serverrlrow.workers.dev/img/1765028107916-cd4eb3e9-7ed4-4c0d-b3d6-c292488d29c1.png)

<font style="color:rgb(51, 51, 51);">ä¸€ä¸Šæ¥å°±æœ‰ä¸ª</font>`ctf.db`<font style="color:rgb(51, 51, 51);">è‚¯å®šä¸å¯¹åŠ²</font>

<font style="color:rgb(51, 51, 51);">æµè§ˆæ•´ä¸ªæ–‡ä»¶å¯ä»¥å‘ç°å¾ˆå¤š</font>**<font style="color:rgb(51, 51, 51);">å‡flag</font>**<font style="color:rgb(51, 51, 51);">,å®é™…ä¸Šæ ¹æ®é¢˜æ„æœ‰</font>**<font style="color:rgb(51, 51, 51);">ä¸¤æ®µ</font>**<font style="color:rgb(51, 51, 51);">,</font>

<font style="color:rgb(51, 51, 51);">æ‰€ä»¥å¯ä»¥ç¡®å®š</font>`PART1:ISCTF{Tom0R1_Dash`æ˜¯ç¬¬ä¸€æ®µ

![](https://md-img.serverrlrow.workers.dev/img/1765028107961-12b15d3e-af57-47e2-b2a4-a1b20dce1535.png)

<font style="color:rgb(51, 51, 51);">æ¥ä¸‹æ¥æ ¹æ®æ¸¸æˆæ•…æ„è¾“äº†åçš„æ–‡å­—,</font>

<font style="color:rgb(51, 51, 51);">å…ˆæ‰“å¼€æºä»£ç ä¸‹çš„</font>`GameOverView`

![](https://md-img.serverrlrow.workers.dev/img/1765028108276-19417e94-76b8-48ce-9ead-0a0697dc7d3a.png)

<font style="color:rgb(51, 51, 51);">å¯ä»¥å‘ç°ä¸€æ®µè¿›è¡Œå¼‚æˆ–çš„æ•°æ®</font>

```python
#åŠ å¯†æ•°ç»„
encrypted = [5, 20, 7, 1, 103, 111, 10, 18, 32, 18, 32, 10, 18, 20, 18, 20, 116, 116, 40]
#å¯†é’¥
key = 85

#è§£å¯†å¹¶æ‹¼æ¥ä¸ºå­—ç¬¦ä¸²
result = "".join([chr(b ^ key) for b in encrypted])
print(result)
```

<font style="color:rgb(51, 51, 51);">å¾—åˆ°ç¬¬äºŒæ®µflag</font>

### æ€ä¹ˆè¿™ä¹Ÿèƒ½æ‰é“¾å­

<font style="color:rgb(51, 51, 51);">vmdkæ–‡ä»¶ä¸‹è½½ä¸‹æ¥å¾ˆå°,æ‰500kb,ç›´æ¥Geminiç§’äº†</font>



> æ–‡ä»¶ç³»ç»Ÿåˆ†æ
> <font style="color:rgb(119, 119, 119);">è¿™ä¸ª VMDK æ–‡ä»¶å®é™…ä¸ŠåŒ…å«äº†ä¸€ä¸ª </font>**<font style="color:rgb(119, 119, 119);">FAT32</font>**<font style="color:rgb(119, 119, 119);"> æ–‡ä»¶ç³»ç»Ÿã€‚é€šè¿‡åˆ†ææ–‡ä»¶å†…å®¹ï¼Œæˆ‘å‘ç°äº†ä¸¤ä¸ªéå¸¸å…³é”®çš„ä¿¡æ¯ç‚¹ï¼šä¸€æ®µç–‘ä¼¼å¯†ç çš„å­—ç¬¦ä¸²å’Œä¸€ä¸ªè¢«éšè—/åˆ é™¤çš„å›¾ç‰‡æ–‡ä»¶ã€‚</font>
> <font style="color:rgb(119, 119, 119);">2. å…³é”®çº¿ç´¢å‘ç°</font>
> <font style="color:rgb(119, 119, 119);">çº¿ç´¢ Aï¼šéšè—çš„å­—ç¬¦ä¸² (å¯èƒ½çš„å¯†ç )</font>
> <font style="color:rgb(119, 119, 119);">åœ¨æ–‡ä»¶åç§»é‡è¾ƒåçš„ä½ç½®ï¼ˆSource 10118 é™„è¿‘ï¼‰ï¼Œæœ‰ä¸€æ®µæ˜æ˜¾çš„æç¤ºæ–‡å­—ã€‚è¿™æ®µæ–‡å­—æ˜¯ä»¥å®½å­—ç¬¦ï¼ˆä¸­é—´æœ‰ç©ºæ ¼/00å­—èŠ‚ï¼‰å½¢å¼å­˜åœ¨çš„ï¼š</font>
> <font style="color:rgb(119, 119, 119);"> o h y o u f i n d i t : E W N V T { R @ X 3 2 _ n a n x 5 d 5 p i x }</font>
> + **<font style="color:rgb(119, 119, 119);">æå–å†…å®¹ï¼š</font>**`oh you find it : EWNVT{R@X32_nanx5d5pix}`
> + **<font style="color:rgb(119, 119, 119);">åˆ†æï¼š</font>**<font style="color:rgb(119, 119, 119);"> è¿™æ®µæ–‡å­—çš„æ ¼å¼éå¸¸åƒ Flagï¼Œä½†ç»“åˆé¢˜ç›®æåˆ°çš„å·¥å…·â€œé™è°§ä¹‹çœ¼â€ï¼Œè¿™æ›´å¯èƒ½æ˜¯</font>**<font style="color:rgb(119, 119, 119);">Silent Eye çš„è§£å¯†å¯†ç ï¼ˆPassphraseï¼‰</font>**<font style="color:rgb(119, 119, 119);">ã€‚</font>
> <font style="color:rgb(119, 119, 119);">çº¿ç´¢ Bï¼šè¢«åˆ é™¤/éšè—çš„å›¾ç‰‡</font>
> <font style="color:rgb(119, 119, 119);">åœ¨æ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•é¡¹åŒºåŸŸï¼ˆSource 10729 é™„è¿‘ï¼‰ï¼Œå‘ç°äº†ä¸€ä¸ªæ–‡ä»¶åä¸º </font>`THIS_IS_FLAG.JPG</font>`<font style="color:rgb(119, 119, 119);"> çš„è®°å½•ï¼ˆçŸ­æ–‡ä»¶åæ˜¾ç¤ºä¸º </font>`THIS_I~1JPG`<font style="color:rgb(119, 119, 119);">ï¼‰ã€‚</font>
> <font style="color:rgb(119, 119, 119);">ç´§æ¥ç€åœ¨ Source 10769 å¤„ï¼Œå¯ä»¥çœ‹åˆ° JPEG å›¾ç‰‡çš„å…¸å‹æ–‡ä»¶å¤´ï¼š</font>
> `Ã¿Ã˜Ã¿Ã  JFIF`<font style="color:rgb(119, 119, 119);"> (å¯¹åº”åå…­è¿›åˆ¶ </font>`FF D8 FF E0`<font style="color:rgb(119, 119, 119);">)</font>
> <font style="color:rgb(119, 119, 119);">å›¾ç‰‡æ•°æ®ä¸€ç›´æŒç»­åˆ° Source 10832 å¤„çš„ JPEG æ–‡ä»¶å°¾ï¼š</font>
> `Ã¿Ã™`<font style="color:rgb(119, 119, 119);"> (å¯¹åº”åå…­è¿›åˆ¶ </font>`FF D9`<font style="color:rgb(119, 119, 119);">)</font>

<font style="color:rgb(51, 51, 51);">010æ‰“å¼€åˆ†å‡ºæ¥å›¾ç‰‡</font>![](https://md-img.serverrlrow.workers.dev/img/1765028108208-bb74ee56-ad2b-4ce1-8178-efdbf3510c45.png)

~~<font style="color:rgb(51, 51, 51);">n1troçš„ç¥ç§˜å¤§å¤´</font>~~

<font style="color:rgb(51, 51, 51);">ç»“åˆé¢˜æ„é™è°§ä¹‹çœ¼,å¯ä»¥çŸ¥é“æ˜¯</font>`silenteye`

<font style="color:rgb(51, 51, 51);">æ‹–è¿›å»æ‰“å¼€æˆ‘ç›´æ¥æŠŠEWNVT{R@X32_nanx5d5pix}å½“å¯†é’¥äº†,ç¬‘æ­»</font>

<font style="color:rgb(51, 51, 51);">é—®äº†ä¸‹å‡ºé¢˜äºº,ç»™äº†æç¤º</font>

<font style="color:rgb(119, 119, 119);">æ²¡æœ‰æ”¹å˜è¿‡Passphrase</font>

<font style="color:rgb(51, 51, 51);">é‚£å°±æ˜¯é»˜è®¤å¯†ç ,ç„¶å</font>`Header position`<font style="color:rgb(51, 51, 51);">è®¾ä¸ºtop</font>

<font style="color:rgb(51, 51, 51);">å¾—åˆ°</font>`welcomeisctf`<font style="color:rgb(51, 51, 51);">,è®©aiå…ˆçŒœå‡ºå‰é¢æ‰¾åˆ°çš„å­—ç¬¦ä¸²ç±»ä¼¼å‡¯æ’’å¯†ç </font>

<font style="color:rgb(51, 51, 51);">ç°åœ¨åˆå¾—åˆ°ä¸²æ–°çš„,åº”è¯¥å°±æ˜¯ç»´å‰å°¼äºšåŠ å¯†çš„key</font>

<font style="color:rgb(51, 51, 51);">éšæ³¢é‡Œå¡«å…¥key,è§£å¯†å¾—åˆ°flag</font>

### æ¶ˆå¤±çš„flag

ä¸€å¼€å§‹éƒ½æ­»æ´»è¿ä¸ä¸Š,æ²¡æœ‰ä»»ä½•å›æ˜¾

é¢˜ç›®ä¸‹æ¶åˆä¸Šæ¥å,æ‰æœ‰äº†errorå›æ˜¾

> <font style="color:rgb(227, 227, 227);background-color:rgb(40, 42, 44);">SSH-2.0-OpenSSH_8.6^M$</font>
>
> <font style="color:rgb(227, 227, 227);background-color:rgb(40, 42, 44);">Invalid SSH identification string.^M$</font>

ç„¶å

```bash
ssh qyy@challenge.bluesharkinfo.com -p 29145
```

å›æ˜¾

---

 |_ _/ __**| / **__**|_   _|  **__**|  
**__**  | |**__**_**__** **__**|**__** |     | | | |**__**  
**__**  | | **__**) | |**__**  | | |  **__**|  
**__** |**__**|**__/ ______| |_| |_|

Connection to challenge.bluesharkinfo.com closed.

é—®äº†ä¸‹aiåº”è¯¥æ˜¯" ç”¨äº†ç‰¹æ®Šçš„é¢œè‰²ä»£ç éšè—èµ·æ¥äº†  "

```bash
ssh qyy@challenge.bluesharkinfo.com -p 29145 | cat -A
```

![](https://md-img.serverrlrow.workers.dev/img/1765029007706-3e740f61-bd31-4cc5-95fd-70c807800c35.jpeg)

è¿™ä¸ªæ—¶å€™æ‰æ˜¾ç¤ºå‡ºæ¥

### Abnormal log

aiç§’äº†

> ###åˆ†æè¿‡ç¨‹
>
> 1. **æ•°æ®ç¢ç‰‡è¯†åˆ«**ï¼š æ—¥å¿—ä¸­åŒ…å«å¤§é‡çš„ `[INFO] Attacker uploading segment X...` å’Œå¯¹åº”çš„ `[INFO] File data segment: <Hex String>`ã€‚è¿™è¡¨æ˜æ”»å‡»è€…å°†ä¸€ä¸ªæ–‡ä»¶åˆ‡åˆ†æˆäº† **116** ä¸ªæ®µè¿›è¡Œä¸Šä¼ ã€‚ ç”±äºæ—¥å¿—æ˜¯ä¹±åºçš„ï¼ˆä¾‹å¦‚ Segment 1 åé¢å¯èƒ½ç´§è·Ÿç€ Segment 30 çš„æ—¥å¿—ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ® `segment ID` å¯¹æ•°æ®è¿›è¡Œé‡æ–°æ’åºã€‚
> 2. **åŠ å¯†/æ··æ·†åˆ†æ**ï¼š è®©æˆ‘ä»¬è§‚å¯Ÿ **Segment 1** çš„æ•°æ®ï¼š `327fb9aa22190501dfbff187e8080505...`
>
> å¦‚æœè¿™åªæ˜¯å•çº¯çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šæŸ¥çœ‹æ–‡ä»¶å¤´ï¼ˆMagic Bytesï¼‰ã€‚å¸¸è§çš„æ–‡ä»¶å¤´å¦‚ä¸‹ï¼š
>
>     - Zip: `50 4B 03 04`
>     - PNG: `89 50 4E 47`
>     - 7z: `37 7A BC AF`
>
> å¯¹æ¯” Segment 1 çš„å¼€å¤´ `32 7f b9 aa` å’Œ 7z çš„æ–‡ä»¶å¤´ `37 7a bc af`ï¼Œä½ ä¼šå‘ç°å®ƒä»¬ä¹‹é—´å­˜åœ¨ä¸€ä¸ªç®€å•çš„ **å¼‚æˆ– (XOR)** å…³ç³»ï¼š
>
>     - `0x32` XOR `0x05` = `0x37` ('7')
>     - `0x7f` XOR `0x05` = `0x7a` ('z')
>     - `0xb9` XOR `0x05` = `0xbc`
>     - `0xaa` XOR `0x05` = `0xaf`
>
> **ç»“è®º**ï¼šæ”»å‡»è€…ä¸Šä¼ çš„æ˜¯ä¸€ä¸ª **7z å‹ç¼©åŒ…**ï¼Œå¹¶ä¸”å¯¹æ‰€æœ‰å­—èŠ‚è¿›è¡Œäº† **0x05 çš„å¼‚æˆ–åŠ å¯†**ã€‚
>
> ###è§£å†³æ–¹æ¡ˆ
>
> æˆ‘ä¸ºä½ ç¼–å†™äº†ä¸€ä¸ª Python è„šæœ¬ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨å®Œæˆä»¥ä¸‹å·¥ä½œï¼š
>
> 1. è§£ææ—¥å¿—ï¼Œæå–æ‰€æœ‰æ•°æ®æ®µã€‚
> 2. æŒ‰ Segment ID (1-116) æ­£ç¡®æ’åºã€‚
> 3. å°†åå…­è¿›åˆ¶è½¬æ¢ä¸ºå­—èŠ‚ã€‚
> 4. åˆ©ç”¨ `0x05` å¯†é’¥è§£å¯†æ•°æ®ã€‚
> 5. ç”Ÿæˆæœ€ç»ˆçš„ `flag.7z` æ–‡ä»¶ã€‚

```python
import re

def solve_ctf():
    log_file = "access.log"
    output_file = "flag.7z"
    xor_key = 0x05

    #ç”¨äºå­˜å‚¨æ®µæ•°æ®çš„å­—å…¸ {id: hex_data}
    segments = {}
    
    current_seg_id = -1
    
    try:
        with open(log_file, "r", encoding="utf-8") as f:
            lines = f.readlines()
            
        for line in lines:
            #1. æ•æ‰æ®µ ID (ä¾‹å¦‚: Attacker uploading segment 1...)
            seg_match = re.search(r'Attacker uploading segment (\d+)', line)
            if seg_match:
                current_seg_id = int(seg_match.group(1))
                continue

            #2. æ•æ‰å¯¹åº”çš„æ•°æ® (ä¾‹å¦‚: File data segment: 327fb9aa...)
            #é€»è¾‘ï¼šæ•°æ®è¡Œé€šå¸¸ç´§è·Ÿåœ¨æ®µå£°æ˜è¡Œæ‰€åœ¨çš„å—ä¸­
            data_match = re.search(r'File data segment: ([0-9a-fA-F]+)', line)
            if data_match and current_seg_id != -1:
                segments[current_seg_id] = data_match.group(1)
                #é‡ç½® ID ä»¥é˜²æ­¢æ•°æ®é”™ä½ï¼ˆè™½ç„¶æ­¤æ—¥å¿—ç»“æ„æ¯”è¾ƒç®€å•ï¼Œä½†è¿™æ›´å®‰å…¨ï¼‰
                current_seg_id = -1

        print(f"[+] æå–åˆ° {len(segments)} ä¸ªæ•°æ®æ®µã€‚")

        #3. æŒ‰é¡ºåºé‡ç»„å¹¶è§£å¯†
        full_hex = ""
        #æ£€æŸ¥æ˜¯å¦æ‰¾é½äº†æ‰€æœ‰æ®µ (1 åˆ° 116)
        sorted_keys = sorted(segments.keys())
        if not sorted_keys:
            print("[-] æœªæ‰¾åˆ°ä»»ä½•æ•°æ®æ®µï¼Œè¯·æ£€æŸ¥æ—¥å¿—æ–‡ä»¶å†…å®¹ã€‚")
            return

        print(f"[+] æ®µ ID èŒƒå›´: {min(sorted_keys)} - {max(sorted_keys)}")

        final_bytes = bytearray()
        
        for i in sorted_keys:
            hex_str = segments[i]
            #å°† Hex è½¬ä¸º byte æ•°ç»„
            chunk_bytes = bytes.fromhex(hex_str)
            #4. XOR è§£å¯†
            for b in chunk_bytes:
                final_bytes.append(b ^ xor_key)

        #5. å†™å…¥æ–‡ä»¶
        with open(output_file, "wb") as f:
            f.write(final_bytes)
            
        print(f"[+] æˆåŠŸï¼æ–‡ä»¶å·²ä¿å­˜ä¸º: {output_file}")
        print("[+] è¯·è§£å‹è¯¥ 7z æ–‡ä»¶ä»¥è·å– flagã€‚")
        
        #éªŒè¯ä¸€ä¸‹æ–‡ä»¶å¤´æ˜¯å¦ä¸º 7z (37 7A BC AF)
        if final_bytes[:4] == b'\x37\x7a\xbc\xaf':
            print("[+] æ–‡ä»¶å¤´æ£€æµ‹æ­£ç¡®ï¼šæ£€æµ‹åˆ° 7z å½’æ¡£æ ¼å¼ã€‚")
        else:
            print("[-] è­¦å‘Šï¼šæ–‡ä»¶å¤´çœ‹èµ·æ¥ä¸æ˜¯ 7zï¼Œå¯èƒ½éœ€è¦æ£€æŸ¥å¼‚æˆ–å¯†é’¥ã€‚")

    except FileNotFoundError:
        print(f"[-] æ‰¾ä¸åˆ°æ–‡ä»¶ {log_file}ï¼Œè¯·ç¡®ä¿è„šæœ¬å’Œæ—¥å¿—åœ¨åŒä¸€ç›®å½•ä¸‹ã€‚")

if __name__ == "__main__":
    solve_ctf()
```

### å°è“é²¨çš„åƒå±‚FLAG

å¾ˆç®€å•çš„ä¸€ä¸ªåµŒå¥—

å†™ä¸ªè„šæœ¬

```python
import pyzipper  #å¿…é¡»å…ˆå®‰è£…: pip install pyzipper
import re
import os
import sys


def unzip_nested(start_filename):
    current_file = start_filename

    print(f"[*] å¼€å§‹ä» {current_file} è§£å‹...")

    while True:
        try:
            #ä¿®æ”¹ç‚¹ã€‘ä½¿ç”¨ pyzipper.AESZipFile æ›¿ä»£ zipfile.ZipFile
            #å®ƒå¯ä»¥å¤„ç† AES åŠ å¯†å’Œä¼ ç»ŸåŠ å¯†
            with pyzipper.AESZipFile(current_file, 'r') as zf:
                #1. è·å–æ³¨é‡Š
                #æœ‰äº›æ—¶å€™æ³¨é‡Šå¯èƒ½æ˜¯ Noneï¼Œåšä¸ªé˜²é”™å¤„ç†
                if zf.comment:
                    comment = zf.comment.decode('utf-8', errors='ignore')
                else:
                    comment = ""

                #2. å¦‚æœæ²¡æœ‰æ³¨é‡Šï¼Œå¯èƒ½å·²ç»è§£å‹å®Œäº†
                if not comment:
                    print(f"\n[+] ç»“æŸ: æ–‡ä»¶ {current_file} æ²¡æœ‰æ³¨é‡Šã€‚")
                    print("æ£€æŸ¥è¯¥æ–‡ä»¶å†…å®¹ï¼ŒFlag å¯èƒ½å°±åœ¨å…¶ä¸­ï¼")
                    break

                #3. æ­£åˆ™æå–å¯†ç 
                match = re.search(r'The password is\s+([^\s]+)', comment)

                if match:
                    password = match.group(1)
                    print(f"[-] æ–‡ä»¶: {current_file} | å¯†ç : {password}")

                    #4. è§£å‹æ–‡ä»¶
                    #setpassword å¯ä»¥å¤„ç† AES å¯†ç 
                    zf.setpassword(password.encode('utf-8'))
                    zf.extractall()

                    #5. æ›´æ–°ä¸‹ä¸€æ¬¡çš„æ–‡ä»¶å
                    #è·å–å‹ç¼©åŒ…å†…ç¬¬ä¸€ä¸ªæ–‡ä»¶çš„åå­—
                    next_file = zf.namelist()[0]
                    current_file = next_file
                else:
                    print(f"\n[!] åœæ­¢: åœ¨ {current_file} çš„æ³¨é‡Šä¸­æœªæ‰¾åˆ°å¯†ç æ¨¡å¼ã€‚")
                    print(f"æ³¨é‡Šå†…å®¹: {comment}")
                    break

        except RuntimeError as e:
            #æ•è·å…·ä½“çš„è§£å‹å¯†ç é”™è¯¯
            if 'Bad password' in str(e):
                print(f"[x] å¯†ç é”™è¯¯: {password}")
                break
            else:
                print(f"[x] è¿è¡Œæ—¶é”™è¯¯: {e}")
                break
        except Exception as e:
            print(f"[x] å‘ç”Ÿé”™è¯¯: {e}")
            break


if __name__ == "__main__":
    start_file = "flagggg999.zip"

    #åˆ‡æ¢åˆ°è„šæœ¬æ‰€åœ¨ç›®å½•ï¼Œé˜²æ­¢è·¯å¾„é”™è¯¯
    script_dir = os.path.dirname(os.path.abspath(__file__))
    os.chdir(script_dir)

    if os.path.exists(start_file):
        unzip_nested(start_file)
    else:
        print(f"é”™è¯¯: å½“å‰ç›®å½•ä¸‹æœªæ‰¾åˆ° {start_file}")
```

ç›´åˆ°flagggg3.zip

æ‰“å¼€å‘ç°é‡Œé¢æ˜¯flagggg.zip

å¾ˆæ˜æ˜¾æ˜¯æ˜æ–‡æ”»å‡»![](https://md-img.serverrlrow.workers.dev/img/1765029637319-4e986ac5-e490-4c08-9720-b04fbfbe7d92.jpeg)

å¯ä»¥çŒœæµ‹2é‡Œé¢æ˜¯flagggg1.zip,ç”±zipç‰¹æ€§,è¿™æ®µæ˜¯flagggg2å†…ä¸€æ®µæ˜æ–‡

å†åŠ ä¸Šzipçš„æ–‡ä»¶å¤´504b0302,ç›´æ¥å¼€å§‹bkcrackçˆ†ç ´

å¾—åˆ°å¯†é’¥è§£å¯†flaggg3

### Image_is_all_you_need

Geminiå¤ªå¼ºå¤§äº†ğŸ–ï¸ğŸ˜­ğŸ¤š

https://gemini.google.com/share/d90753b7c4a0

### å°è“é²¨çš„å‘¨å¹´åº†ç¤¼ç‰©

010æ‰“å¼€`è¿™é‡Œæ²¡æœ‰flag`å…¨æ˜¯æ··ä¹±çš„æ•°æ®,è¿™ä¸ªæ—¶å€™çœ‹ä¸€çœ¼æ–‡ä»¶å¤§å°,okå›ºå®š10mb

æ²¡æœ‰ç‰¹å¾å°±æ˜¯æœ€å¤§çš„ç‰¹å¾,å¾ˆå…¸å‹çš„VCåŠ å¯†å®¹å™¨

ç›´æ¥Vera cryptæŒ‚è½½,æ—è¾¹çš„å›¾ç‰‡å°±ä½œä¸ºå¯†é’¥

æ‰“å¼€æ–‡ä»¶,æ‹–å…¥éšæ³¢å‘ç°æœ‰é›¶å®½éšå†™

æŒ‰ç…§å‡ºç°äº†å“ªäº›é›¶å®½å­—ç¬¦æ¥è§£å¯†,å¾—åˆ°flag





# åº”æ€¥

## hacker

wiresharkæ‰“å¼€ä¹‹åç›´æ¥åè®®åˆ†çº§,æŒ‰åˆ†ç»„æ’åº,ä¸€ä¸ªä¸€ä¸ªå°è¯•äº¤

## å¥‡æ€ªçš„shellæ–‡ä»¶

è§£å‹ä¹‹å,ç«ç»’ç›´æ¥æŠ¥æ¯’,æ‰¾åˆ°shellæ–‡ä»¶,

ç”± ä»£ç ä¸­æœ‰ä¸€è¡Œæ³¨é‡Šï¼š`//è¯¥å¯†é’¥ä¸ºè¿æ¥å¯†ç 32ä½md5å€¼çš„å‰16ä½`

å’Œ

```php
$post=file_get_contents("php://input");
```

å¯ä»¥çŸ¥é“æ˜¯å†°è3

# ç—…æ¯’åˆ†æ

å‚è€ƒæ–‡ç« :

+ [æ¸…å¤œæ— å°˜ã®ä¸€æ–¹å¤©åœ° | MSI TRANSFORMSæŠ€æœ¯åˆ†æ](https://wander1ng.com/post/msi-transforms%E6%8A%80%E6%9C%AF%E5%88%86%E6%9E%90/)
+ [MSI Shenanigans. Part 1 â€“ Offensive Capabilities Overview â€“ mgeekyâ€™s lair](https://mgeeky.tech/msi-shenanigans-part-1/)
+ [MSIæ–‡ä»¶æ»¥ç”¨æ–°è¶‹åŠ¿ï¼šæ–°æµ·è²èŠ±ç»„ç»‡é¦–åº¦åˆ©ç”¨MSTæ–‡ä»¶æŠ•é€’ç‰¹é©¬](https://ti.qianxin.com/blog/articles/new%20-trend-in-msi-file-abuse-new-oceanlotus-group-first-to-use-mst-files-to-deliver-special-trojan-cn/)

å…ˆè®©aiå’Œäº‘æ²™ç®±åˆ†æä¸‹

![](https://md-img.serverrlrow.workers.dev/img/1765098397456-4c936a23-2d70-450f-befc-c06133e4d123.jpeg)

> ### æ ·æœ¬æ¦‚è§ˆä¸å…³è”åˆ†æ
>
> ä½ æä¾›çš„ä¸‰ä¸ªæ–‡ä»¶çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªæ”»å‡»é“¾çš„ä¸åŒéƒ¨åˆ†ï¼š
>
> 1. `**ISCTFåŸºç¡€è§„åˆ™è¯´æ˜æ–‡æ¡£.pdf.lnk**`: è¿™æ˜¯ä¸€ä¸ª Windows å¿«æ·æ–¹å¼æ–‡ä»¶ (LNK)ã€‚
> 2. `**fR6Wl**`: ä¸€ä¸ª PE æ ¼å¼çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆæ ¹æ® `!This program cannot be run in DOS mode` å’Œ Zoom ç­¾ååˆ¤æ–­ï¼‰ã€‚
> 3. `**TJe1w**`: ä¸€ä¸ªåŒ…å«å¤§é‡å®‰è£…ç¨‹åºè¡¨ç»“æ„ï¼ˆMSI Databaseï¼‰æ•°æ®çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚
>
> **æ¨æµ‹çš„æ”»å‡»é€»è¾‘ï¼š** é€šå¸¸æµ·è²èŠ±çš„æ”»å‡»é“¾å¦‚ä¸‹ï¼š `LNK å¿«æ·æ–¹å¼` -> `è§£å‹/é‡Šæ”¾æ–‡ä»¶` -> `è¿è¡Œåˆæ³•çš„ç™½æ–‡ä»¶ (fR6Wl)` -> `ç™½æ–‡ä»¶åŠ è½½æ¶æ„çš„ DLL (é€šå¸¸åœ¨åŒç›®å½•ä¸‹)` -> `æ¶æ„ DLL è¯»å–åŠ å¯†çš„ Payload` -> `å†…å­˜åŠ è½½ Shellcode`ã€‚

### æ¨¡ä»¿çš„APTç»„ç»‡ä¸­æ–‡ä»£å·ä¸º

æµ·è²èŠ±

### ç¬¬ä¸€é˜¶æ®µè½½è·ä¸­çš„å…¥å£æ–‡ä»¶å…¨åä¸º

**<font style="color:rgb(38, 38, 38);background-color:rgba(0, 0, 0, 0.06);">ISCTFåŸºç¡€è§„åˆ™è¯´æ˜æ–‡æ¡£.pdf.lnk</font>**

### ç¬¬ä¸€é˜¶æ®µä¸­ä½¿ç”¨äº†ä¸€ä¸ªå¸¦æœ‰æ•°å­—ç­¾åçš„æ–‡ä»¶ï¼ˆéç³»ç»Ÿæ–‡ä»¶ï¼‰ï¼Œå…¶ä¸­ç­¾åè€…åç§°ä¸º

> #### `TJe1w` (Source 2226-2466)
>
> + **æ–‡ä»¶è¯†åˆ«**: è¿™æ˜¯ä¸€ä¸ª **Windows PE æ–‡ä»¶** (DLL æˆ– EXE)ã€‚
> + **å…³é”®å­—ç¬¦ä¸²**:
>     - `Zoom Remote Control Installer`
>     - `Zoom Video Communications, Inc.`
>     - `zRC.dll`, `zRCAppCore.dll`, `zNet.dll`
>     - `DigiCert Trusted Root G4` (æ•°å­—ç­¾åä¿¡æ¯)
> + **åˆ†æç»“è®º**: è¿™æ˜¯ä¸€ä¸ª **åˆæ³•çš„ã€å¸¦æœ‰æ•°å­—ç­¾åçš„ Zoom ç»„ä»¶**ã€‚



å¾ˆæ˜¾ç„¶<font style="color:rgb(38, 38, 38);background-color:rgba(0, 0, 0, 0.06);">Zoom Video Communications, Inc.</font>

### ç¬¬ä¸€é˜¶æ®µä¸­æ¶æ„è½½è·é‡Šæ”¾çš„æ–‡ä»¶ååˆ†åˆ«ä¸ºï¼ˆæäº¤ä¸‰æ¬¡ï¼Œæ¯æ¬¡ä¸€ä¸ªæ–‡ä»¶åï¼‰

ç›´æ¥åˆ†æ**<font style="color:rgb(38, 38, 38);background-color:rgba(0, 0, 0, 0.06);">fR6Wl</font>**

åœ¨ç½‘ç»œä¸Šä¸Šæœç´¢msiæ–‡ä»¶åˆ†æ,å¯ä»¥å…ˆç®€å•ç”¨7zè§£å‹



![](https://md-img.serverrlrow.workers.dev/img/1765100306392-7d6cca69-2d1f-4225-86d8-bf0b5fbad063.jpeg)

æ‰¾åˆ°äºŒè¿›åˆ¶æ–‡ä»¶binary.ztool

ç”¨ida-proæ‰“å¼€,å¯åŠ¨mcpæœåŠ¡è®©aiåˆ†æ![](https://md-img.serverrlrow.workers.dev/img/1765100449990-bd953a48-dd54-461b-b180-a7f9bd290be3.jpeg)

æ‰¾åˆ°ä¸¤ä¸ª,ç¬¬ä¸‰ä¸ªè®©reæ‰‹æ‰¾åˆ°æ˜¯Isctf2025.pdf

### ç¬¬äºŒé˜¶æ®µä½¿ç”¨äº†ä¸€ç§å¸¸è§çš„ç™½åŠ é»‘æŠ€å·§ï¼Œå…¶ä¸­é»‘æ–‡ä»¶åä¸º

ä¸‰ä¸ªéƒ½æäº¤äº†çœ‹çœ‹,ç»“æœæ˜¯\\ZoomRemoteControl\\bin\\zRCAppCore.dll

### ç¬¬äºŒé˜¶æ®µå¯¹ä¸‹ä¸€é˜¶æ®µè½½è·è¿›è¡Œäº†ç®€å•çš„ä¿æŠ¤ï¼Œä¿æŠ¤ä½¿ç”¨çš„ç®—æ³•ä¸º

![](https://md-img.serverrlrow.workers.dev/img/1765100820272-2740430c-266b-488e-bbe5-7522c8e65663.jpeg)

å°±æ˜¯å¼‚æˆ–,å¯†é’¥ä¹Ÿæ‰¾åˆ°äº†ä½†æäº¤ä¸å¯¹





# Reverse

[https://share.note.youdao.com/s/Z5BGNBru](https://share.note.youdao.com/s/Z5BGNBru)